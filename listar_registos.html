
<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <title>Lista de Registos</title>
  https://apis.google.com/js/api.js
</head>
<body>
  <h3>Registos Guardados</h3>
  <div id="listaRegistos"></div>

  <button onclick="window.location.href='index.html'">Voltar</button>
  <button id="auth-button" style="display:none;" onclick="handleAuthClick()">Ver Eventos no Calend√°rio</button>
  <ul id="eventos"></ul>

  <script>
    const CLIENT_ID = "589806164758-ih56j11pura4chq8ddemeeia6ljs7r2u.apps.googleusercontent.com";
    const DISCOVERY_DOCS = ["https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest"];
    const SCOPES = "https://www.googleapis.com/auth/calendar.readonly";

    function handleClientLoad() {
      gapi.load("client:auth2", initClient);
    }

    function initClient() {
      gapi.client.init({
        clientId: CLIENT_ID,
        discoveryDocs: DISCOVERY_DOCS,
        scope: SCOPES
      }).then(() => {
        document.getElementById("auth-button").style.display = "block";
      });
    }

    function handleAuthClick() {
      gapi.auth2.getAuthInstance().signIn().then(listUpcomingEvents);
    }

    function listUpcomingEvents() {
      gapi.client.calendar.events.list({
        calendarId: "primary",
        timeMin: new Date().toISOString(),
        showDeleted: false,
        singleEvents: true,
        maxResults: 10,
        orderBy: "startTime"
      }).then(response => {
        const events = response.result.items;
        const lista = document.getElementById("eventos");
        lista.innerHTML = "";
        if (events.length > 0) {
          events.forEach(event => {
            const li = document.createElement("li");
            const when = event.start.dateTime || event.start.date;
            li.textContent = `${event.summary} (${when})`;
            lista.appendChild(li);
          });
        } else {
          lista.innerHTML = "<li>Sem eventos encontrados.</li>";
        }
      });
    }

    handleClientLoad();
  </script>
</body>
</html>

